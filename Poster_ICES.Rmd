---
main_topsize: 0.2 #percent coverage of the poster
main_bottomsize: 0.1
#ESSENTIALS
title: Use of management strategy evaluation to inform in fisheries management in a changing climate
author:
  - name: '**Jonathan W. Cummings**'
    affil: 1
    main: true
    orcid: '0000-0001-8028-5787'
    twitter: jonwcummings 
    email: 'jcummings@umassd.edu'
  - name: Amanda Hart
    affil: 1
    main: true
    orcid: '0000-0002-6449-9328'
    email: 'ahart2@umassd.edu'
  - name: Gavin Fay
    main: true
    affil: 1
    email: 'gfay@umassd.edu'
affiliation:
  - num: 1
    address: School for Marine Science and Technology, University of Massachusetts - Dartmouth 836 South Rodney French Blvd,New Bedford, MA, USA 02744
main_findings:
  - "Make **better posters** with RMarkdown + **posterdown**.
  Use of management strategy evaluation to inform in fisheries management in a changing climate"
logoleft_name: https&#58;//raw.githubusercontent.com/brentthorne/posterdown/master/images/betterhexlogo.png
logoright_name: https&#58;//raw.githubusercontent.com/brentthorne/posterdown/master/images/betterhexlogo.png
logocenter_name: https&#58;//raw.githubusercontent.com/brentthorne/posterdown/master/images/qr-code-black.png
output: 
  posterdown::posterdown_betterport:
    self_contained: false
    pandoc_args: --mathjax
    number_sections: false
bibliography: packages.bib
link-citations: true
---
```{r, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      tidy = FALSE,
                      message = FALSE,
                      fig.align = 'center',
                      out.width = "100%")
options(knitr.table.format = "html")
##### load libraries #####
library(tidyverse) # upgrade to base R
library(readxl) # read in excel files
library(shiny) # Shiny App
library(shinythemes) # web themes for Shiny
library(DT) # Data Table
library(purrr) # for loop alternative
library(ggmap) # map plotting
library(mapdata) # basemap generation
library(odbc) # database connection 
library(RMySQL) # MySQL scripting in R
library(DBI) # database interface

load("C:/Users/jcummings/OneDrive - UMASS Dartmouth/SMAST/Research/MSE Problem Framing/MSEreview/MSEreview.RData")

study<-study %>% 
  unite(Citation,c(Authors,YearPub),sep=" ",remove=F)

mgmt.join<-mgmt %>% 
  group_by(fkStudyID) %>%
  summarise(ManagementType = toString(sort(unique(ManagementType))),
            AlternativesEvaluated = toString(sort(unique(AlternativesEvaluated))))

obj.join<-obj %>%
  group_by(fkStudyID) %>%
  summarise(ObjectiveCategories = toString(sort(unique(ObjCategory))))

# Join tables
data<-full_join(study,mgmt.join,by=c("ID"="fkStudyID"))
data<-full_join(data,obj.join,by=c("ID"="fkStudyID"))

# Move comment column to the end
data<-data %>%
  select(-'Comments', 'Comments')

# Filter data
data_pub<-filter(data,IncludeInPublication==TRUE)
data_CC<-filter(data,str_detect(Drivers,"Climate Change"))

data_pub.join<-data_pub %>%
  select(ID,Citation)
data_CC.join<-data_CC %>%
  select(ID,Citation)

obj.data_pub<-left_join(data_pub.join,obj,by=c("ID"="fkStudyID"))%>%
  select(-c("ID","ID.y"))
obj.data_CC<-left_join(data_CC.join,obj,by=c("ID"="fkStudyID"))%>%
  select(-c("ID","ID.y"))

alt.data_pub<-left_join(data_pub.join,mgmt,by=c("ID"="fkStudyID"))%>%
  select(-c("ID","ID.y"))
alt.data_CC<-left_join(data_CC.join,mgmt,by=c("ID"="fkStudyID"))%>%
  select(-c("ID","ID.y"))

data_pub<-data_pub %>%
  select(-c("ID"))
data_CC<-data_CC %>%
  select(-c("ID"))

# Get columns whose width needs editing
targets<-match(c("FullCitation","Comments"),names(data))

#####-- Data analysis --#####
# Get columns for study summary
summary.col<-c("Citation",
               "Species",
               "Location",
               "System")
# Get columns for study drivers and problem
prob.col<-c("Citation",
            "ProblemDefinition",
            "Drivers",
            "ConsequencePrediction",
            "TradeOffMethod_Exp",
            "TradeOffMethod_Sub",
            "Decision")
# Get columns for frequency analysis
freq.col<-c("ProcessExplicit",
            "ProblemDefinitionExplicit",
            "ObjectivesExplicit",
            "AlternativesExplicit",
            "TradeOffsExplicit",
            "DecisionExplicit",
            "RolesExplicit",
            "OpenMeetings",
            "ResultsAdopted")
# Get columns for participant analysis
part.col<-c("Leader",
            "Participants",
            "ObjElicitationSource_Exp",
            "ProcedureElicitation_Exp",
            "ObjElicitationSource_Sub",
            "ProcedureElicitation_Sub")
obj.col<-c("ObjType",
           "ObjCategory",
           "ObjDirection",
           "ObjScale")
alt.col<-c("ManagementType",
           "AlternativesEvaluated")
# Get columns for map
map.col<-c("Latitude",
           "Longitude",
           "Citation",
           "Drivers")

# Select data summary columns
summary.data_pub<-data_pub %>%
    select(summary.col)
summary.data_CC<-data_CC %>%
  select(summary.col)

# Frequency of method
n_mse<-nrow(data)
n_pub<-nrow(data_pub)
n_obj_pub<-nrow(obj.data_pub)
n_CC<-nrow(data_CC)
n_obj_CC<-nrow(obj.data_CC)

freq.data_pub<-data_pub %>%
    select(freq.col) %>%
    rename("Process"="ProcessExplicit",
           "Problem"="ProblemDefinitionExplicit",
           "Objectives"="ObjectivesExplicit",
           "Alternatives"="AlternativesExplicit",
           "Tradeoffs"="TradeOffsExplicit",
           "Decision"="DecisionExplicit",
           "Roles"="RolesExplicit",
           "Open Meetings"="OpenMeetings",
           "Adopted"="ResultsAdopted") %>%
    summarise_all(funs(sum))%>%
    gather(Explicit) %>%
    mutate(Percent=value/n_mse*100) %>%
    mutate(Explicit=factor(Explicit,levels=
                  c("Process","Problem","Objectives","Alternatives","Tradeoffs","Decision",
                               "Roles","Open Meetings","Adopted"))) %>%
    rename("Number"="value")

freq.data_CC<-data_CC %>%
  select(freq.col) %>%
  rename("Process"="ProcessExplicit",
         "Problem"="ProblemDefinitionExplicit",
         "Objectives"="ObjectivesExplicit",
         "Alternatives"="AlternativesExplicit",
         "Tradeoffs"="TradeOffsExplicit",
         "Decision"="DecisionExplicit",
         "Roles"="RolesExplicit",
         "Open Meetings"="OpenMeetings",
         "Adopted"="ResultsAdopted") %>%
  summarise_all(funs(sum))%>%
  gather(Explicit) %>%
  mutate(Percent=value/n_mse*100) %>%
  mutate(Explicit=factor(Explicit,levels=
                           c("Process","Problem","Objectives","Alternatives","Tradeoffs","Decision",
                             "Roles","Open Meetings","Adopted"))) %>%
  rename("Number"="value")

# Who participates
part.data_pub<-data_pub %>%
    select(part.col) %>%
    rename("Process"="Leader",
           "Doc Objectives"="ObjElicitationSource_Exp",
           "Doc Alternatives"="ProcedureElicitation_Exp",
           "Sub Objectives"="ObjElicitationSource_Sub",
           "Sub Alternatives"="ProcedureElicitation_Sub")

part.data_pub<- part.data_pub %>%
    purrr::map(~ strsplit(as.character(.),split=",")) %>%
    purrr::map(unlist) %>%
    purrr::map(table)


part.data_pub<-plyr::ldply(part.data_pub,data.frame)
colnames(part.data_pub)<-c("Stage","Participants","Number")

neworder <- c("Process","Participants","Doc Objectives",
              "Sub Objectives","Doc Alternatives",
              "Sub Alternatives")
newlabels <- c("Process","Participants","Explicit Objectives Process",
               "Subjective Objectives Process","Explicit Alternatives Process",
               "Subjective Alternatives Process")

part.data_pub <- part.data_pub %>%
    mutate(Percent=Number/n_pub*100) %>%
    mutate(Stage=factor(Stage,levels=neworder,labels=newlabels)) %>%
    ungroup() %>%
    # 2. Arrange by
    #   i.  facet group =Stage
    #   ii. bar height
    arrange(Stage, Percent) %>%
    # 3. Add order column of row numbers
    mutate(order = row_number())

part.data_CC<-data_CC %>%
  select(part.col) %>%
  rename("Process"="Leader",
         "Doc Objectives"="ObjElicitationSource_Exp",
         "Doc Alternatives"="ProcedureElicitation_Exp",
         "Sub Objectives"="ObjElicitationSource_Sub",
         "Sub Alternatives"="ProcedureElicitation_Sub")

part.data_CC<- part.data_CC %>%
  purrr::map(~ strsplit(as.character(.),split=",")) %>%
  purrr::map(unlist) %>%
  purrr::map(table)


part.data_CC<-plyr::ldply(part.data_CC,data.frame)
colnames(part.data_CC)<-c("Stage","Participants","Number")

part.data_CC <- part.data_CC %>%
  mutate(Percent=Number/n_CC*100) %>%
  mutate(Stage=factor(Stage,levels=neworder,labels=newlabels)) %>%
  ungroup() %>%
  # 2. Arrange by
  #   i.  facet group =Stage
  #   ii. bar height
  arrange(Stage, Percent) %>%
  # 3. Add order column of row numbers
  mutate(order = row_number())

part.dataTable_pub<-part.data_pub %>%
    as_tibble() %>%
    select(Stage,Participants,Number) %>%
    rename("Participant Group"="Participants") %>%
    spread(Stage,Number,fill=0)

part.dataTable_CC<-part.data_CC %>%
  as_tibble() %>%
  select(Stage,Participants,Number) %>%
  rename("Participant Group"="Participants") %>%
  spread(Stage,Number,fill=0)

# What drivers are considered
drive.data_pub<-data_pub %>%
    select(Drivers) %>%
    purrr::map(~ strsplit(as.character(.),split=",")) %>%
    purrr::map(unlist) %>%
    purrr::map(table) %>%
    plyr::ldply(data.frame) %>%
    select(Var1,Freq) %>%
    rename("Driver"="Var1","Frequency"="Freq") %>%
    mutate(Percent=Frequency/n_pub*100) %>%
    arrange(desc(Frequency))

drive.data_CC<-data_CC %>%
  select(Drivers) %>%
  purrr::map(~ strsplit(as.character(.),split=",")) %>%
  purrr::map(unlist) %>%
  purrr::map(table) %>%
  plyr::ldply(data.frame) %>%
  select(Var1,Freq) %>%
  rename("Driver"="Var1","Frequency"="Freq") %>%
  mutate(Percent=Frequency/n_CC*100) %>%
  arrange(desc(Frequency))

# What objectives categories were considered
objcat.data_pub<-data_pub %>%
    select(ObjectiveCategories) %>%
    purrr::map(~ strsplit(as.character(.),split=", ")) %>%
    purrr::map(unlist) %>%
    purrr::map(table) %>%
    plyr::ldply(data.frame) %>%
    select(Var1,Freq) %>%
    rename("Objective Category"="Var1","Frequency"="Freq") %>%
    mutate(Percent=Frequency/n_pub*100) %>%
    arrange(desc(Frequency))

objcat.data_CC<-data_CC %>%
  select(ObjectiveCategories) %>%
  purrr::map(~ strsplit(as.character(.),split=", ")) %>%
  purrr::map(unlist) %>%
  purrr::map(table) %>%
  plyr::ldply(data.frame) %>%
  select(Var1,Freq) %>%
  rename("Objective Category"="Var1","Frequency"="Freq") %>%
  mutate(Percent=Frequency/n_CC*100) %>%
  arrange(desc(Frequency))

# How were objectives defined
obj.data_pub<-obj.data_pub %>%
  select(obj.col) %>%
  purrr::map(table) %>%
  plyr::ldply(data.frame)

obj.data_CC<-obj.data_CC %>%
  select(obj.col) %>%
  purrr::map(table) %>%
  plyr::ldply(data.frame)

colnames(obj.data_pub)<-colnames(obj.data_CC)<-c("Objective","Type","Number")

neworder <- c("ObjCategory","ObjType","ObjDirection","ObjScale")
newlabels <- c("Category","Type","Direction","Scale")

# What Objective types are considered
obj.dataTable_pub <- obj.data_pub %>%
  mutate(Percent=round(Number/n_obj_pub*100,0)) %>%
  mutate('Per MSE'=round(Number/n_pub,2)) %>%
  mutate(Objective=factor(Objective,levels=neworder,labels=newlabels)) %>%
  arrange(Objective,desc(Number))

obj.dataTable_CC <- obj.data_CC %>%
  mutate(Percent=round(Number/n_obj_CC*100,0)) %>%
  mutate('Per MSE'=round(Number/n_CC,2)) %>%
  mutate(Objective=factor(Objective,levels=neworder,labels=newlabels)) %>%
  arrange(Objective,desc(Number))

# What Alternative types are considered
altcat.data_pub<-alt.data_pub %>%
    select(ManagementType) %>%
    purrr::map(~ strsplit(as.character(.),split=",")) %>%
    purrr::map(unlist) %>%
    purrr::map(table) %>%
    plyr::ldply(data.frame) %>%
    select(Var1,Freq) %>%
    rename("Management Type"="Var1","Number"="Freq") %>%
    mutate(Percent=round(Number/n_pub*100,0)) %>%
    mutate('Per MSE'=round(Number/n_pub,2)) %>%
    arrange(desc(Number))

altcat.data_CC<-alt.data_CC %>%
  select(ManagementType) %>%
  purrr::map(~ strsplit(as.character(.),split=", ")) %>%
  purrr::map(unlist) %>%
  purrr::map(table) %>%
  plyr::ldply(data.frame) %>%
  select(Var1,Freq) %>%
  rename("Management Type"="Var1","Number"="Freq") %>%
  mutate(Percent=round(Number/n_CC*100,0)) %>%
  mutate('Per MSE'=round(Number/n_CC,2)) %>%
  arrange(desc(Number))

# Get map background for plotting the map
world <- borders("world", colour="gray50", fill="gray50", alpha=0.75) # create a layer of borders

# Where MSEs have occured
map.data<-rbind(data_pub,data_CC) %>%
  select(map.col) %>%
  mutate(Drivers=str_extract(Drivers, "Climate Change")) %>%
  mutate(Drivers=replace_na(Drivers, "Other"))

# label MSEs articles by analysis for ploting
freq.data_pub<-mutate(freq.data_pub,Analysis="Publication")
freq.data_CC<-mutate(freq.data_CC,Analysis="Climate Change")
freq.data<-rbind(freq.data_pub,freq.data_CC)
part.data_pub<-mutate(part.data_pub,Analysis="Publication")
part.data_CC<-mutate(part.data_CC,Analysis="Climate Change")
part.data<-rbind(part.data_pub,part.data_CC) %>% 
  arrange(Stage, Percent) %>%
  mutate(order = row_number())
part.data$order<-c(1,2,3,3,4,4,5,6,7,8,6,9,10,8,9,11,12,10,13,12,13,14,14,15,16,17,18,19,20,16,17,18,20,21,22,23,24,25,21,23,26,25,26,27,27,28,29,30,31,29,32,30,33,32,33,34,35,36,37,38,39,39)


# ##### Data Analysis Outputs #####
# # number of climate change MSE articles
# # n_CC
# 
# # plot MSEs on map
# MSE.map<-ggplot(data=map.data,aes(x=Longitude, y=Latitude,color=Drivers)) + world +
#   geom_point(size=2) + scale_color_manual(values=c("#FF0033","#0000FF")) +  theme_void() +
#   theme(legend.position = c(0.15, 0.25))
# 
# # plot explicit documentation of steps or components of MSE processes 
# # Publication MSEs
# Freq.plot_pub<-ggplot(freq.data_pub,aes(Explicit,Percent))+
#     geom_col()+geom_vline(xintercept=3.5,linetype="dashed")+
#     coord_flip()+scale_y_continuous(limits=c(0,100),expand = c(0,0))+xlab(NULL)+
#     scale_x_discrete(
#       limits=c("Adopted","Open Meetings","Roles","Decision","Tradeoffs",
#                "Alternatives","Objectives","Problem","Process"), 
#       labels=c("Adopted","Open Meetings","Roles","Decision","Tradeoffs",
#                "Alternatives","Objectives","Problem","Process"))
# 
# #Climate Change MSEs
# Freq.plot_CC<-ggplot(freq.data_CC,aes(Explicit,Percent))+
#   geom_col()+geom_vline(xintercept=3.5,linetype="dashed")+
#   coord_flip()+scale_y_continuous(limits=c(0,100),expand = c(0,0))+xlab(NULL)+
#   scale_x_discrete(
#     limits=c("Adopted","Open Meetings","Roles","Decision","Tradeoffs",
#              "Alternatives","Objectives","Problem","Process"), 
#     labels=c("Adopted","Open Meetings","Roles","Decision","Tradeoffs",
#              "Alternatives","Objectives","Problem","Process"))
# 
# Freq.plot<-ggplot(freq.data,aes(Explicit,Percent,fill=Analysis))+
#   geom_col(position="dodge")+geom_vline(xintercept=3.5,linetype="dashed")+
#   coord_flip()+scale_fill_manual(values=c("#FF0033","#0000FF")) +
#   scale_y_continuous(limits=c(0,100),expand = c(0,0))+xlab(NULL)+
#   scale_x_discrete(
#     limits=c("Adopted","Open Meetings","Roles","Decision","Tradeoffs",
#              "Alternatives","Objectives","Problem","Process"), 
#     labels=c("Adopted","Open Meetings","Roles","Decision","Tradeoffs",
#              "Alternatives","Objectives","Problem","Process")) +
#   guides(fill = guide_legend(reverse=T)) + theme_bw()
# 
# Part.plot_pub<-ggplot(part.data_pub,aes(x=order,y=Percent)) +
#     facet_wrap(~Stage,scale="free",ncol=2) + geom_col() +  
#     scale_x_continuous(breaks = part.data_pub$order,
#       labels = part.data_pub$Participants)+
#   scale_y_continuous(limits=c(0,100),expand = c(0,0)) +
#     ylab("Percent")+coord_flip()
# 
# Part.plot_CC<-ggplot(part.data_CC,aes(x=order,y=Percent)) +
#   facet_wrap(~Stage,scale="free",ncol=2) + geom_col() +  
#   scale_x_continuous(breaks = part.data_CC$order,
#                      labels = part.data_CC$Participants)+
#   scale_y_continuous(limits=c(0,100),expand = c(0,0)) +
#   ylab("Percent")+coord_flip()
# 
# Part.plot<-ggplot(part.data,aes(x=order,y=Percent,fill=Analysis)) +
#   facet_wrap(~Stage,scale="free",ncol=2) + geom_col(position="dodge") +  
#   scale_fill_manual(values=c("#FF0033","#0000FF")) +
#   scale_x_continuous(breaks = part.data$order,
#                      labels = part.data$Participants)+
#   scale_y_continuous(limits=c(0,100),expand = c(0,0)) +
#   ylab("Percent")+xlab(NULL)+coord_flip() + 
#   guides(fill = guide_legend(reverse=T)) + theme_bw() +
#   theme(legend.position = c(0.875,0.085),legend.title = element_blank())
# 
# as_tibble(summary.data_pub)
# as_tibble(summary.data_CC)
```

# Introduction

For most of its history fisheries management has taken place against the backdrop of ecosystem status with fishing impacts occupying center stage.  However, the increased rate and degree of ecosystem climatic change is also bringing ecosystem status to the forefront of fisheries management.
Management strategy evaluation (MSE) is commonly considered the gold standard of fisheries management approaches, and is "widely considered to be the most appropriate way to evaluate the trade‐offs achieved by alternative management strategies and to assess the consequences of uncertainty for achieving management goals” (citation). Thus, MSE is a compelling tool to address the impact of climate change on fisheries management.
Despite numerous applications of MSE, the application that include climate change are limited, leaving uncertainty about the best approach to applying MSEs that account for a changing environment.


```{r, include=FALSE}
knitr::write_bib(c('posterdown', 'rmarkdown','pagedown'), 'packages.bib')
```

## Objectives

Adaptive management arose to address uncertainties and accelerate progress towards meeting management objectives. With an eye towards adaptive management, we seek to note the lessons learned from successful MSEs to:

* Highlight unique aspects of MSEs that model climate change as a driver
* Identify shortcomings in MSE documentation that delays learning
* Identify aspects of successful MSEs that can be adopted to inform fisheries management in a changing climate

Need climate change imagery

Need MSE imagery

Need learning and adaptive management imagery

# Methods

MSE articles Reviewed
We conducted our search for management strategy evaluation documents using the Web of Science database.  We searched in topic for “management strategy evaluation” on January 8th, 2019 in the SCI-EXPANDED index with a timespan of all years.  This search returned 253 results.  We sampled this list of 253 potential management strategy evaluations without replacement to produce an ordered list of articles for potential review.  We reviewed the first 30 articles in this randomly ordered list that document a management strategy evaluation.  Not all articles in the potential pool of 253 articles were management strategy evaluations.  For example, once published the article would be returned by our Web of Science search, but as this is a review it is not documenting a management strategy evaluation.

Identify management strategy evaluations that include climate change:
Web of science  
details  
Score the MSE documentation:  
Steps  
Problem  
Objectives  
Alternatives  
Consequences  
Trade-offs  
Decision  
Participants  
Roles  

We highlight lessons learned from these exercises and unique aspects of MSEs that model climate change as a driver relative to a sample of MSEs that do not consider climate change.


I will show here how to include poster elements that may be useful, such as an equation using mathjax:

$$
E = mc^2
$$

To reference a citation you can add your `.bib` file to the working directory and name it in the YAML metadata or generate an automated one as done here, then you only need to reference the label value in the `.bib` file. For example this package is built on top of the wonderful {pagedown} package and I will cite it at the end of this sentance using this in the rmd `[@R-pagedown]` [@R-pagedown].

To get a better understanding of how to include features like these please refer to the {posterdown} [wiki](https://github.com/posterdown/wiki).

**_Now on to the results!_**

# Results

Relatively few cases of climate change MSEs  
Less likely to include stakeholders  

Here you may have some figures to show off, bellow I have made a scatterplot with the infamous Iris dataset and I can even reference to the figure automatically like this, `Figure \@ref(fig:irisfigure)`, Figure \@ref(fig:irisfigure).

```{r, irisfigure, fig.cap='Here is a caption for the figure. This can be added by using the "fig.cap" option in the r code chunk options, see this [link](https://yihui.name/knitr/options/#plots) from the legend himself, [Yihui Xie](https://twitter.com/xieyihui).', out.width="80%"}
par(mar=c(2,2,0,1))
plot(x = iris$Sepal.Length, y = iris$Sepal.Width,
     col = iris$Species, pch = 19, xlab = "Sepal Length",
     ylab = "Sepal Width")
```

Maybe you want to show off some of that fancy code you spent so much time on to make that figure, well you can do that too! Just use the `echo=TRUE` option in the r code chunk options, Figure \@ref(fig:myprettycode)!

```{r myprettycode, echo=TRUE, fig.cap='Boxplots, so hot right now!', fig.height=6, out.width="80%"}
#trim whitespace
par(mar=c(2,2,0,0))
#plot boxplots
boxplot(iris$Sepal.Width~iris$Species,
        col = "#008080", 
        border = "#0b4545",
        ylab = "Sepal Width (cm)",
        xlab = "Species")
```

How about a neat table of data? See, Table \@ref(tab:iristable):

```{r, iristable}
knitr::kable(
  iris[1:15,1:5], format = "html",
  caption = "A table made with the **knitr::kable** function.",
  align = "c", col.names = c("Sepal <br> Length",
                             "Sepal <br> Width",
                             "Petal <br> Length",
                             "Petal <br> Width",
                             "Species"),
  escape = FALSE)
```

# References
